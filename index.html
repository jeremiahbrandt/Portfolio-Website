<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Personal portfolio website for Jeremiah Brandt">
        <meta name="keywords" content="HTML, CSS, JavaScript, Web developer, Web designer, Node, Java, PHP, React, SQL, MongoDB">
        <meta name="author" content="Jeremiah Brandt">
        <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">    
        <link href="css/variables.css" type="text/css" rel="stylesheet">
        <link href="css/style.css" type="text/css" rel="stylesheet">
        <link href="css/mobile.css" type="text/css" rel="stylesheet">
        <link href="css/desktop.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <nav>
            <div id="hamburger" onclick="toggleNavigation()">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div id="links">
                <a href="#about">About</a>
                <a href="#portfolio">Portfolio</a>
                <a href="#contact">Contact</a>
            </div>
        </nav>
        <main>
            <section id="bio">
                <h1>About Me</h1>
                <img src="#" alt="Picture of Jeremiah Brandt" id="#bio-picture" />
                <p id="bio-paragraph">Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quidem repellat, ut magnam dolore incidunt voluptatem ipsa eaque doloremque quae odit assumenda velit. Vitae aliquid tenetur debitis rerum, labore ipsum recusandae?</p>
            </section>
            <section id="portfolio">
                <h1 id="portfolio-title">Portfolio</h1>
                <div id="portfolio-items"></div>
            </section>
            <form action="" method="GET" id="contact">
                <h1>Contact</h1>
                <fieldset id="contact-name">
                    <label for="name">Name:</label>
                    <input name="tel" type="tel" />
                </fieldset>
                <fieldset id="contact-phone">
                    <label for="phone">Phone Number:</label>
                    <input name="text" type="text" required/>
                </fieldset>
                <fieldset id="contact-email">
                    <label for="email">Email Address:</label>
                    <input name="email" type="email" />
                </fieldset>
                <fieldset id="contact-message">
                    <label for="message">Message:</label>
                    <textarea name="message"></textarea>
                </fieldset>
            </form>
        </main>
        <footer>
            <span id="copyright">
                Copyright <span id="date"></span><a href="http://jeremiahbrandt.com"> Jeremiah Brandt</a>
            </span>
        </footer>
    </body>
    <script>
        const toggleNavigation = () => {
            const links = document.getElementById("links");
            if(links.classList.contains("shown")) {
                links.classList.remove("shown");
            } else {
                links.classList.add("shown");
            }
        }

        const getGithubData = async (githubUsername) => {
            const data = await(await fetch(`https://api.github.com/users/${githubUsername}`)).json();
            return data;
        }

        const getPortfolio = async (githubUsername) => {
            const repos = await(await fetch(`https://api.github.com/users/${githubUsername}/repos`)).json();
            return repos;
        }

        const userName = "jeremiahbrandt";
        // TOD: Reisize images to be consistent
        const repoImages = [
            "./images/joes-barber-shop.png",
            "./images/jj-firewood.png",
            "./images/joes-barber-shop.png",
            "./images/jj-firewood.png",
            // "./images/portfolio-website.png",
            // "./images/weather-app.png"
        ];
        
        getGithubData(userName).then(data => {
            // TODO: Remove
            // console.log(data);

            document.getElementById("#bio-picture").setAttribute("src", data.avatar_url);
            document.getElementById("bio-paragraph").innerHTML = data.bio;
        });

        getPortfolio(userName).then(repos => {
            // TODO: Remove
            // console.log(repos);

            const portfolioNode = document.getElementById("portfolio-items");
            repos.map((repo, index) => {
                // Image was not supplied and repo will not be displayed
                if(repoImages[index] == undefined) {
                    return;
                }
                 const portfolioItemNode = document.createElement("div");
                 portfolioItemNode.className = "portfolio-item";

                // Title
                const titleNode = document.createElement("h2");
                const titleText = document.createTextNode(repo.name);
                titleNode.appendChild(titleText);
                portfolioItemNode.append(titleNode);

                const imageNode = document.createElement("img");
                imageNode.alt = "Repository image";
                imageNode.src = repoImages[index];
                portfolioItemNode.append(imageNode);

                // Description
                const descNode = document.createElement("p");
                const descText = document.createTextNode(repo.description);
                descNode.appendChild(descText);
                portfolioItemNode.append(descNode);

                // Live preview link
                const previewNode = document.createElement('a');
                const previewText = document.createTextNode("View Preview");
                previewNode.appendChild(previewText);
                previewNode.id = "preview-link";
                previewNode.title = "View live preview";
                previewNode.href= repo.homepage;
                portfolioItemNode.append(previewNode);


                // Code link
                const codeNode = document.createElement('a');
                const codeText = document.createTextNode("View Code");
                codeNode.appendChild(codeText);
                codeNode.id = "code-link";
                codeNode.title = "View code on GitHub";
                codeNode.href= repo.html_url;
                portfolioItemNode.append(codeNode);

                portfolioNode.append(portfolioItemNode);
            })
        });

        // Update Copyright date
        document.getElementById("date").innerHTML = new Date().getFullYear();
    </script>
</html>